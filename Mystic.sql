-- --------------------------------------------------------
-- Host:                         127.0.0.1
-- Versión del servidor:         10.4.32-MariaDB - mariadb.org binary distribution
-- SO del servidor:              Win64
-- HeidiSQL Versión:             12.5.0.6677
-- --------------------------------------------------------

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET NAMES utf8 */;
/*!50503 SET NAMES utf8mb4 */;
/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
/*!40103 SET TIME_ZONE='+00:00' */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;


-- Volcando estructura de base de datos para mystic_reservas
CREATE DATABASE IF NOT EXISTS `mystic_reservas` /*!40100 DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci */;
USE `mystic_reservas`;

-- Volcando estructura para tabla mystic_reservas.clientes
CREATE TABLE IF NOT EXISTS `clientes` (
  `id_cliente` int(11) NOT NULL AUTO_INCREMENT,
  `nombre` varchar(120) NOT NULL,
  `cedula` varchar(20) NOT NULL,
  `whatsapp` varchar(25) NOT NULL,
  `correo` varchar(150) DEFAULT NULL,
  `ciudad` varchar(100) DEFAULT NULL,
  `cumple` date DEFAULT NULL,
  `edad` tinyint(3) unsigned DEFAULT NULL,
  `estrato` varchar(10) DEFAULT NULL,
  `profesion` varchar(120) DEFAULT NULL,
  `creado_en` timestamp NOT NULL DEFAULT current_timestamp(),
  `medio` varchar(50) DEFAULT NULL,
  PRIMARY KEY (`id_cliente`),
  UNIQUE KEY `cedula` (`cedula`),
  KEY `idx_clientes_cedula` (`cedula`),
  KEY `idx_clientes_nombre` (`nombre`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- Volcando datos para la tabla mystic_reservas.clientes: ~0 rows (aproximadamente)

-- Volcando estructura para tabla mystic_reservas.pagos
CREATE TABLE IF NOT EXISTS `pagos` (
  `id_pago` int(11) NOT NULL AUTO_INCREMENT,
  `id_reserva` int(11) NOT NULL,
  `num_pago` tinyint(3) unsigned NOT NULL,
  `fecha` date NOT NULL,
  `metodo` enum('DATÁFONO','TRANSFERENCIA','EFECTIVO','OTRO') NOT NULL DEFAULT 'EFECTIVO',
  `valor` int(10) unsigned NOT NULL,
  `nota` varchar(255) DEFAULT NULL,
  `creado_en` timestamp NOT NULL DEFAULT current_timestamp(),
  PRIMARY KEY (`id_pago`),
  KEY `idx_pagos_reserva` (`id_reserva`),
  CONSTRAINT `fk_pago_reserva` FOREIGN KEY (`id_reserva`) REFERENCES `reservas` (`id_reserva`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- Volcando datos para la tabla mystic_reservas.pagos: ~0 rows (aproximadamente)

-- Volcando estructura para tabla mystic_reservas.planes
CREATE TABLE IF NOT EXISTS `planes` (
  `id_plan` int(11) NOT NULL AUTO_INCREMENT,
  `nombre` varchar(150) NOT NULL,
  `tipo` enum('PAREJA','AMIGOS','FAMILIA','EMPRESAS','OTRO') DEFAULT 'OTRO',
  `noches_default` int(10) unsigned DEFAULT NULL,
  `activo` tinyint(1) NOT NULL DEFAULT 1,
  `creado_en` timestamp NOT NULL DEFAULT current_timestamp(),
  PRIMARY KEY (`id_plan`),
  UNIQUE KEY `nombre` (`nombre`)
) ENGINE=InnoDB AUTO_INCREMENT=33 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- Volcando datos para la tabla mystic_reservas.planes: ~32 rows (aproximadamente)
INSERT INTO `planes` (`id_plan`, `nombre`, `tipo`, `noches_default`, `activo`, `creado_en`) VALUES
	(1, 'Pareja Full Vacacional', 'PAREJA', 4, 1, '2025-11-18 18:48:44'),
	(2, 'Pareja Mystic Dual (2x1)', 'PAREJA', 3, 1, '2025-11-18 18:48:44'),
	(3, 'Pareja Fresh Vacacional', 'PAREJA', 3, 1, '2025-11-18 18:48:44'),
	(4, 'Pareja Full Adventure', 'PAREJA', 2, 1, '2025-11-18 18:48:44'),
	(5, 'Pareja Free Adventure', 'PAREJA', 2, 1, '2025-11-18 18:48:44'),
	(6, 'Plan Mystic Luxury Love (Pareja)', 'PAREJA', 1, 1, '2025-11-18 18:48:44'),
	(7, 'Plan Mystic Love (Pareja)', 'PAREJA', 1, 1, '2025-11-18 18:48:44'),
	(8, 'Pareja One Premium', 'PAREJA', 1, 1, '2025-11-18 18:48:44'),
	(9, 'Pareja One Esencial', 'PAREJA', 1, 1, '2025-11-18 18:48:44'),
	(10, 'Pareja Lite', 'PAREJA', 1, 1, '2025-11-18 18:48:44'),
	(11, 'Amigos Full Vacacional', 'AMIGOS', 4, 1, '2025-11-18 18:48:44'),
	(12, 'Amigos Fresh Vacacional', 'AMIGOS', 3, 1, '2025-11-18 18:48:44'),
	(13, 'Amigos Mystic Dual 2x1', 'AMIGOS', 3, 1, '2025-11-18 18:48:44'),
	(14, 'Amigos Full Adventure', 'AMIGOS', 2, 1, '2025-11-18 18:48:44'),
	(15, 'Amigos Free Adventure', 'AMIGOS', 2, 1, '2025-11-18 18:48:44'),
	(16, 'Amigos One Premium', 'AMIGOS', 1, 1, '2025-11-18 18:48:44'),
	(17, 'Amigos One Esencial', 'AMIGOS', 1, 1, '2025-11-18 18:48:44'),
	(18, 'Amigos Lite', 'AMIGOS', 1, 1, '2025-11-18 18:48:44'),
	(19, 'Empresas Full Vacacional (por persona)', 'EMPRESAS', 4, 1, '2025-11-18 18:48:44'),
	(20, 'Empresas Fresh Vacacional (por persona)', 'EMPRESAS', 3, 1, '2025-11-18 18:48:44'),
	(21, 'Empresas Full Adventure (por persona)', 'EMPRESAS', 2, 1, '2025-11-18 18:48:44'),
	(22, 'Empresas One Premium (por persona)', 'EMPRESAS', 1, 1, '2025-11-18 18:48:44'),
	(23, 'Empresas One Esencial (Pasadía, por persona)', 'EMPRESAS', NULL, 1, '2025-11-18 18:48:44'),
	(24, 'Familia Full Vacacional (Mystic Natural)', 'FAMILIA', 4, 1, '2025-11-18 18:48:44'),
	(25, 'Familia Full Vacacional (Mystic Paradise)', 'FAMILIA', 4, 1, '2025-11-18 18:48:44'),
	(26, 'Familia Fresh Vacacional', 'FAMILIA', 3, 1, '2025-11-18 18:48:44'),
	(27, 'Familia Mystic Dual 2x1', 'FAMILIA', 3, 1, '2025-11-18 18:48:44'),
	(28, 'Familia Full Adventure', 'FAMILIA', 2, 1, '2025-11-18 18:48:44'),
	(29, 'Familia Free Adventure', 'FAMILIA', 2, 1, '2025-11-18 18:48:44'),
	(30, 'Familia One Premium', 'FAMILIA', 1, 1, '2025-11-18 18:48:44'),
	(31, 'Familia One Esencial', 'FAMILIA', 1, 1, '2025-11-18 18:48:44'),
	(32, 'Familia Lite', 'FAMILIA', 1, 1, '2025-11-18 18:48:44');

-- Volcando estructura para tabla mystic_reservas.planes_servicios
CREATE TABLE IF NOT EXISTS `planes_servicios` (
  `id_plan` int(11) NOT NULL,
  `id_servicio` int(11) NOT NULL,
  `cantidad_incluida` int(10) unsigned NOT NULL DEFAULT 1,
  `obligatorio` tinyint(1) NOT NULL DEFAULT 1,
  PRIMARY KEY (`id_plan`,`id_servicio`),
  KEY `fk_ps_servicio` (`id_servicio`),
  CONSTRAINT `fk_ps_plan` FOREIGN KEY (`id_plan`) REFERENCES `planes` (`id_plan`),
  CONSTRAINT `fk_ps_servicio` FOREIGN KEY (`id_servicio`) REFERENCES `servicios` (`id_servicio`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- Volcando datos para la tabla mystic_reservas.planes_servicios: ~314 rows (aproximadamente)
INSERT INTO `planes_servicios` (`id_plan`, `id_servicio`, `cantidad_incluida`, `obligatorio`) VALUES
	(1, 7, 1, 1),
	(1, 18, 1, 1),
	(1, 22, 1, 1),
	(1, 35, 1, 1),
	(1, 37, 1, 1),
	(1, 38, 1, 1),
	(1, 39, 1, 1),
	(1, 45, 1, 1),
	(1, 46, 1, 1),
	(1, 49, 1, 1),
	(2, 7, 1, 1),
	(2, 18, 1, 1),
	(2, 22, 1, 1),
	(2, 35, 1, 1),
	(2, 37, 1, 1),
	(2, 38, 1, 1),
	(2, 39, 1, 1),
	(2, 45, 1, 1),
	(2, 46, 1, 1),
	(2, 49, 1, 1),
	(3, 7, 1, 1),
	(3, 18, 1, 1),
	(3, 22, 1, 1),
	(3, 35, 1, 1),
	(3, 37, 1, 1),
	(3, 38, 1, 1),
	(3, 39, 1, 1),
	(3, 45, 1, 1),
	(3, 47, 1, 1),
	(3, 49, 1, 1),
	(4, 7, 1, 1),
	(4, 18, 1, 1),
	(4, 22, 1, 1),
	(4, 35, 1, 1),
	(4, 37, 1, 1),
	(4, 38, 1, 1),
	(4, 39, 1, 1),
	(4, 46, 1, 1),
	(4, 49, 1, 1),
	(5, 7, 1, 1),
	(5, 18, 1, 1),
	(5, 22, 1, 1),
	(5, 37, 1, 1),
	(5, 38, 1, 1),
	(5, 39, 1, 1),
	(5, 45, 1, 1),
	(5, 47, 1, 1),
	(5, 49, 1, 1),
	(6, 7, 1, 1),
	(6, 18, 1, 1),
	(6, 22, 1, 1),
	(6, 35, 1, 1),
	(6, 37, 1, 1),
	(6, 38, 1, 1),
	(6, 39, 1, 1),
	(6, 45, 1, 1),
	(6, 46, 1, 1),
	(6, 49, 1, 1),
	(7, 7, 1, 1),
	(7, 18, 1, 1),
	(7, 22, 1, 1),
	(7, 35, 1, 1),
	(7, 37, 1, 1),
	(7, 38, 1, 1),
	(7, 39, 1, 1),
	(7, 45, 1, 1),
	(7, 46, 1, 1),
	(7, 49, 1, 1),
	(8, 7, 1, 1),
	(8, 18, 1, 1),
	(8, 22, 1, 1),
	(8, 35, 1, 1),
	(8, 37, 1, 1),
	(8, 38, 1, 1),
	(8, 39, 1, 1),
	(8, 45, 1, 1),
	(8, 46, 1, 1),
	(8, 49, 1, 1),
	(9, 7, 1, 1),
	(9, 18, 1, 1),
	(9, 22, 1, 1),
	(9, 37, 1, 1),
	(9, 38, 1, 1),
	(9, 39, 1, 1),
	(9, 45, 1, 1),
	(9, 49, 1, 1),
	(10, 7, 1, 1),
	(10, 18, 1, 1),
	(10, 22, 1, 1),
	(10, 37, 1, 1),
	(10, 38, 1, 1),
	(10, 39, 1, 1),
	(10, 45, 1, 1),
	(10, 49, 1, 1),
	(11, 7, 1, 1),
	(11, 18, 1, 1),
	(11, 22, 1, 1),
	(11, 35, 1, 1),
	(11, 37, 1, 1),
	(11, 38, 1, 1),
	(11, 39, 1, 1),
	(11, 45, 1, 1),
	(11, 46, 1, 1),
	(11, 49, 1, 1),
	(12, 7, 1, 1),
	(12, 18, 1, 1),
	(12, 22, 1, 1),
	(12, 35, 1, 1),
	(12, 37, 1, 1),
	(12, 38, 1, 1),
	(12, 39, 1, 1),
	(12, 45, 1, 1),
	(12, 47, 1, 1),
	(12, 49, 1, 1),
	(13, 7, 1, 1),
	(13, 18, 1, 1),
	(13, 22, 1, 1),
	(13, 35, 1, 1),
	(13, 37, 1, 1),
	(13, 38, 1, 1),
	(13, 39, 1, 1),
	(13, 45, 1, 1),
	(13, 46, 1, 1),
	(13, 49, 1, 1),
	(14, 7, 1, 1),
	(14, 18, 1, 1),
	(14, 22, 1, 1),
	(14, 35, 1, 1),
	(14, 37, 1, 1),
	(14, 38, 1, 1),
	(14, 39, 1, 1),
	(14, 46, 1, 1),
	(14, 49, 1, 1),
	(15, 7, 1, 1),
	(15, 18, 1, 1),
	(15, 22, 1, 1),
	(15, 37, 1, 1),
	(15, 38, 1, 1),
	(15, 39, 1, 1),
	(15, 45, 1, 1),
	(15, 47, 1, 1),
	(15, 49, 1, 1),
	(16, 7, 1, 1),
	(16, 18, 1, 1),
	(16, 22, 1, 1),
	(16, 35, 1, 1),
	(16, 37, 1, 1),
	(16, 38, 1, 1),
	(16, 39, 1, 1),
	(16, 45, 1, 1),
	(16, 46, 1, 1),
	(16, 49, 1, 1),
	(17, 7, 1, 1),
	(17, 18, 1, 1),
	(17, 22, 1, 1),
	(17, 37, 1, 1),
	(17, 38, 1, 1),
	(17, 39, 1, 1),
	(17, 45, 1, 1),
	(17, 49, 1, 1),
	(18, 7, 1, 1),
	(18, 18, 1, 1),
	(18, 22, 1, 1),
	(18, 37, 1, 1),
	(18, 38, 1, 1),
	(18, 39, 1, 1),
	(18, 45, 1, 1),
	(18, 49, 1, 1),
	(19, 7, 1, 1),
	(19, 11, 1, 1),
	(19, 12, 1, 1),
	(19, 18, 1, 1),
	(19, 22, 1, 1),
	(19, 31, 1, 1),
	(19, 37, 1, 1),
	(19, 38, 1, 1),
	(19, 39, 1, 1),
	(19, 45, 1, 1),
	(19, 47, 1, 1),
	(19, 49, 1, 1),
	(20, 7, 1, 1),
	(20, 11, 1, 1),
	(20, 12, 1, 1),
	(20, 18, 1, 1),
	(20, 22, 1, 1),
	(20, 31, 1, 1),
	(20, 37, 1, 1),
	(20, 38, 1, 1),
	(20, 39, 1, 1),
	(20, 45, 1, 1),
	(20, 47, 1, 1),
	(20, 49, 1, 1),
	(21, 7, 1, 1),
	(21, 11, 1, 1),
	(21, 12, 1, 1),
	(21, 18, 1, 1),
	(21, 22, 1, 1),
	(21, 31, 1, 1),
	(21, 37, 1, 1),
	(21, 38, 1, 1),
	(21, 39, 1, 1),
	(21, 45, 1, 1),
	(21, 47, 1, 1),
	(21, 49, 1, 1),
	(22, 7, 1, 1),
	(22, 11, 1, 1),
	(22, 12, 1, 1),
	(22, 18, 1, 1),
	(22, 22, 1, 1),
	(22, 31, 1, 1),
	(22, 37, 1, 1),
	(22, 38, 1, 1),
	(22, 39, 1, 1),
	(22, 45, 1, 1),
	(22, 47, 1, 1),
	(22, 49, 1, 1),
	(23, 7, 1, 1),
	(23, 11, 1, 1),
	(23, 12, 1, 1),
	(23, 18, 1, 1),
	(23, 22, 1, 1),
	(23, 31, 1, 1),
	(23, 37, 1, 1),
	(23, 38, 1, 1),
	(23, 39, 1, 1),
	(23, 45, 1, 1),
	(23, 47, 1, 1),
	(23, 49, 1, 1),
	(24, 7, 1, 1),
	(24, 18, 1, 1),
	(24, 22, 1, 1),
	(24, 35, 1, 1),
	(24, 37, 1, 1),
	(24, 38, 1, 1),
	(24, 39, 1, 1),
	(24, 45, 1, 1),
	(24, 47, 1, 1),
	(24, 49, 1, 1),
	(25, 7, 1, 1),
	(25, 18, 1, 1),
	(25, 22, 1, 1),
	(25, 35, 1, 1),
	(25, 37, 1, 1),
	(25, 38, 1, 1),
	(25, 39, 1, 1),
	(25, 45, 1, 1),
	(25, 47, 1, 1),
	(25, 49, 1, 1),
	(26, 7, 1, 1),
	(26, 18, 1, 1),
	(26, 22, 1, 1),
	(26, 35, 1, 1),
	(26, 37, 1, 1),
	(26, 38, 1, 1),
	(26, 39, 1, 1),
	(26, 45, 1, 1),
	(26, 47, 1, 1),
	(26, 49, 1, 1),
	(27, 7, 1, 1),
	(27, 18, 1, 1),
	(27, 22, 1, 1),
	(27, 35, 1, 1),
	(27, 37, 1, 1),
	(27, 38, 1, 1),
	(27, 39, 1, 1),
	(27, 45, 1, 1),
	(27, 47, 1, 1),
	(27, 49, 1, 1),
	(28, 7, 1, 1),
	(28, 18, 1, 1),
	(28, 22, 1, 1),
	(28, 35, 1, 1),
	(28, 37, 1, 1),
	(28, 38, 1, 1),
	(28, 39, 1, 1),
	(28, 45, 1, 1),
	(28, 47, 1, 1),
	(28, 49, 1, 1),
	(29, 7, 1, 1),
	(29, 18, 1, 1),
	(29, 22, 1, 1),
	(29, 37, 1, 1),
	(29, 38, 1, 1),
	(29, 39, 1, 1),
	(29, 45, 1, 1),
	(29, 47, 1, 1),
	(29, 49, 1, 1),
	(30, 7, 1, 1),
	(30, 18, 1, 1),
	(30, 22, 1, 1),
	(30, 35, 1, 1),
	(30, 37, 1, 1),
	(30, 38, 1, 1),
	(30, 39, 1, 1),
	(30, 45, 1, 1),
	(30, 47, 1, 1),
	(30, 49, 1, 1),
	(31, 7, 1, 1),
	(31, 18, 1, 1),
	(31, 22, 1, 1),
	(31, 37, 1, 1),
	(31, 38, 1, 1),
	(31, 39, 1, 1),
	(31, 45, 1, 1),
	(31, 47, 1, 1),
	(31, 49, 1, 1),
	(32, 7, 1, 1),
	(32, 18, 1, 1),
	(32, 22, 1, 1),
	(32, 37, 1, 1),
	(32, 38, 1, 1),
	(32, 39, 1, 1),
	(32, 45, 1, 1),
	(32, 49, 1, 1);

-- Volcando estructura para tabla mystic_reservas.reservas
CREATE TABLE IF NOT EXISTS `reservas` (
  `id_reserva` int(11) NOT NULL AUTO_INCREMENT,
  `id_cliente` int(11) NOT NULL,
  `id_plan` int(11) DEFAULT NULL,
  `tipo_alojamiento` enum('glamping','camping','room') DEFAULT NULL,
  `numero_alojamiento` int(11) DEFAULT NULL,
  `codigo` varchar(30) NOT NULL,
  `plan_nombre` varchar(150) NOT NULL,
  `fecha_ingreso` date NOT NULL,
  `hora` time DEFAULT NULL,
  `noches` int(10) unsigned NOT NULL DEFAULT 1,
  `adultos` int(10) unsigned NOT NULL DEFAULT 2,
  `menores` int(10) unsigned NOT NULL DEFAULT 0,
  `precio_unit` int(10) unsigned DEFAULT 0,
  `valor_base` int(10) unsigned DEFAULT 0,
  `valor_extras` int(10) unsigned DEFAULT 0,
  `descuento_porcentaje` tinyint(3) unsigned DEFAULT 0,
  `descuento_valor` int(10) unsigned DEFAULT 0,
  `valor_total` int(10) unsigned NOT NULL DEFAULT 0,
  `saldo` int(10) unsigned NOT NULL DEFAULT 0,
  `parqueadero` varchar(10) DEFAULT NULL,
  `medio` varchar(80) DEFAULT NULL,
  `agente` varchar(120) DEFAULT NULL,
  `observaciones` text DEFAULT NULL,
  `pago_total` int(10) unsigned DEFAULT 0,
  `pago_efectivo` int(10) unsigned DEFAULT 0,
  `pago_transferencia` int(10) unsigned DEFAULT 0,
  `pago_datafono` int(10) unsigned DEFAULT 0,
  `id_usuario` int(11) DEFAULT NULL,
  `estado` enum('RESERVADA','CHECKIN','CHECKOUT','CANCELADA') DEFAULT 'RESERVADA',
  `creado_en` timestamp NOT NULL DEFAULT current_timestamp(),
  `actualizado_en` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),
  PRIMARY KEY (`id_reserva`),
  KEY `fk_reserva_plan` (`id_plan`),
  KEY `fk_reserva_usuario` (`id_usuario`),
  KEY `idx_reservas_cliente_fecha` (`id_cliente`,`fecha_ingreso`),
  KEY `idx_reservas_fecha` (`fecha_ingreso`),
  CONSTRAINT `fk_reserva_cliente` FOREIGN KEY (`id_cliente`) REFERENCES `clientes` (`id_cliente`),
  CONSTRAINT `fk_reserva_plan` FOREIGN KEY (`id_plan`) REFERENCES `planes` (`id_plan`),
  CONSTRAINT `fk_reserva_usuario` FOREIGN KEY (`id_usuario`) REFERENCES `usuarios` (`id_usuario`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- Volcando datos para la tabla mystic_reservas.reservas: ~0 rows (aproximadamente)

-- Volcando estructura para tabla mystic_reservas.reservas_servicios
CREATE TABLE IF NOT EXISTS `reservas_servicios` (
  `id_reserva_servicio` int(11) NOT NULL AUTO_INCREMENT,
  `id_reserva` int(11) NOT NULL,
  `id_servicio` int(11) NOT NULL,
  `cantidad` int(11) NOT NULL,
  `incluido_en_plan` tinyint(1) DEFAULT 0,
  `precio_unit_aplicado` int(11) DEFAULT 0,
  `total_linea` int(11) DEFAULT 0,
  `incluidas` int(11) DEFAULT 0,
  PRIMARY KEY (`id_reserva_servicio`),
  KEY `fk_rs_servicio` (`id_servicio`),
  KEY `idx_rs_reserva` (`id_reserva`),
  CONSTRAINT `fk_rs_reserva` FOREIGN KEY (`id_reserva`) REFERENCES `reservas` (`id_reserva`),
  CONSTRAINT `fk_rs_servicio` FOREIGN KEY (`id_servicio`) REFERENCES `servicios` (`id_servicio`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- Volcando datos para la tabla mystic_reservas.reservas_servicios: ~0 rows (aproximadamente)

-- Volcando estructura para tabla mystic_reservas.reserva_auditoria
CREATE TABLE IF NOT EXISTS `reserva_auditoria` (
  `id_auditoria` int(11) NOT NULL AUTO_INCREMENT,
  `id_reserva` int(11) NOT NULL,
  `usuario_id` int(11) DEFAULT NULL,
  `usuario_rol` enum('ASESOR','ADMIN','RECEPCION','OTRO','DESCONOCIDO') DEFAULT 'DESCONOCIDO',
  `accion` enum('CREACION','ACTUALIZACION','CANCELACION') NOT NULL DEFAULT 'ACTUALIZACION',
  `cambios` text DEFAULT NULL,
  `fecha` timestamp NOT NULL DEFAULT current_timestamp(),
  PRIMARY KEY (`id_auditoria`),
  KEY `idx_aud_reserva` (`id_reserva`),
  KEY `fk_aud_usuario` (`usuario_id`),
  CONSTRAINT `fk_aud_reserva` FOREIGN KEY (`id_reserva`) REFERENCES `reservas` (`id_reserva`),
  CONSTRAINT `fk_aud_usuario` FOREIGN KEY (`usuario_id`) REFERENCES `usuarios` (`id_usuario`)
) ENGINE=InnoDB AUTO_INCREMENT=4 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- Volcando datos para la tabla mystic_reservas.reserva_auditoria: ~3 rows (aproximadamente)
INSERT INTO `reserva_auditoria` (`id_auditoria`, `id_reserva`, `usuario_id`, `usuario_rol`, `accion`, `cambios`, `fecha`) VALUES
	(1, 1, 1, 'ADMIN', 'ACTUALIZACION', '{"antes":{"cedula_cliente":"1113592222","plan_nombre":"Amigos Lite","valor_extras":0,"pago_total":220000,"pago_efectivo":0,"pago_transferencia":0,"pago_datafono":0,"saldo":20000,"nombre_cliente":"Saday","whatsapp":"3158819322","codigo":"123","fecha_ingreso":"2025-12-05","noches":1,"adultos":2,"menores":0,"id_plan":18,"valor_total":240000,"observaciones":"nada"},"despues":{"cedula_cliente":"1113592222","plan_nombre":"Amigos Lite","valor_extras":0,"pago_total":230000,"pago_efectivo":0,"pago_transferencia":0,"pago_datafono":0,"saldo":10000,"nombre_cliente":"Saday","whatsapp":"3158819322","codigo":"123","fecha_ingreso":"2025-12-05","noches":1,"adultos":2,"menores":0,"id_plan":18,"valor_total":240000,"observaciones":"nada"},"extras":{"nuevo_servicio":null,"nuevo_pago":{"fecha":"2025-12-03","metodo":"banco","monto":10000,"nota":""}}}', '2025-12-03 19:50:13'),
	(2, 1, 1, 'ADMIN', 'ACTUALIZACION', '{"antes":{"cedula_cliente":"1113592222","plan_nombre":"Amigos Lite","valor_extras":0,"pago_total":230000,"pago_efectivo":0,"pago_transferencia":0,"pago_datafono":0,"saldo":10000,"nombre_cliente":"Saday","whatsapp":"3158819322","codigo":"123","fecha_ingreso":"2025-12-05","noches":1,"adultos":2,"menores":0,"id_plan":18,"valor_total":240000,"observaciones":"nada"},"despues":{"cedula_cliente":"1113592222","plan_nombre":"Amigos Lite","valor_extras":55000,"pago_total":230000,"pago_efectivo":0,"pago_transferencia":0,"pago_datafono":0,"saldo":65000,"nombre_cliente":"Saday","whatsapp":"3158819322","codigo":"123","fecha_ingreso":"2025-12-05","noches":1,"adultos":2,"menores":0,"id_plan":18,"valor_total":295000,"observaciones":"nada"},"extras":{"nuevo_servicio":{"id_servicio":24,"cantidad":1},"nuevo_pago":null}}', '2025-12-03 19:56:52'),
	(3, 1, 1, 'ADMIN', 'ACTUALIZACION', '{"antes":{"cedula_cliente":"1113592222","plan_nombre":"Amigos Lite","valor_extras":55000,"pago_total":230000,"pago_efectivo":0,"pago_transferencia":0,"pago_datafono":0,"saldo":65000,"nombre_cliente":"Saday","whatsapp":"3158819322","codigo":"123","fecha_ingreso":"2025-12-05","noches":1,"adultos":2,"menores":0,"id_plan":18,"valor_total":295000,"observaciones":"nada"},"despues":{"cedula_cliente":"1113592222","plan_nombre":"Amigos Lite","valor_extras":55000,"pago_total":245000,"pago_efectivo":15000,"pago_transferencia":0,"pago_datafono":0,"saldo":50000,"nombre_cliente":"Saday","whatsapp":"3158819322","codigo":"123","fecha_ingreso":"2025-12-05","noches":1,"adultos":2,"menores":0,"id_plan":18,"valor_total":295000,"observaciones":"nada"},"extras":{"nuevo_servicio":null,"nuevo_pago":{"fecha":"2025-12-03","metodo":"EFECTIVO","monto":15000,"nota":""}}}', '2025-12-03 20:14:12');

-- Volcando estructura para tabla mystic_reservas.servicios
CREATE TABLE IF NOT EXISTS `servicios` (
  `id_servicio` int(11) NOT NULL AUTO_INCREMENT,
  `categoria` varchar(80) NOT NULL,
  `nombre` varchar(150) NOT NULL,
  `precio_base` int(10) unsigned NOT NULL DEFAULT 0,
  `activo` tinyint(1) NOT NULL DEFAULT 1,
  PRIMARY KEY (`id_servicio`),
  UNIQUE KEY `uk_servicios_categoria_nombre` (`categoria`,`nombre`)
) ENGINE=InnoDB AUTO_INCREMENT=52 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- Volcando datos para la tabla mystic_reservas.servicios: ~51 rows (aproximadamente)
INSERT INTO `servicios` (`id_servicio`, `categoria`, `nombre`, `precio_base`, `activo`) VALUES
	(1, 'Hospedaje', 'Glamping Entre Semana', 350000, 1),
	(2, 'Hospedaje', 'Glamping Sábados y Festivos', 550000, 1),
	(3, 'Hospedaje', 'Glamping Incremento Festivo (aparte)', 50000, 1),
	(4, 'Hospedaje', 'Habitación Adulto', 94500, 1),
	(5, 'Hospedaje', 'Habitación Menor de edad', 42500, 1),
	(6, 'Hospedaje', 'Habitación Pareja', 189000, 1),
	(7, 'Fogata / Fuego', 'Kit Fogata Completo', 17000, 1),
	(8, 'Fogata / Fuego', 'Atado Leña', 9000, 1),
	(9, 'Fogata / Fuego', 'Masmelos', 7000, 1),
	(10, 'Fogata / Fuego', 'Petrobarra', 3500, 1),
	(11, 'Alimentación', 'Pasa Tarde Adulto', 25000, 1),
	(12, 'Alimentación', 'Pasa Tarde Menor de edad', 12500, 1),
	(13, 'Alimentación', 'Picnic Romántico', 120000, 1),
	(14, 'Alimentación', 'Desayuno', 17000, 1),
	(15, 'Alimentación', 'Almuerzo', 30000, 1),
	(16, 'Alimentación', 'Cena', 27500, 1),
	(17, 'Alimentación', 'Desayuno y Almuerzo', 44500, 1),
	(18, 'Alimentación', 'Cena y Desayuno', 42000, 1),
	(19, 'Alimentación', 'Alimentación Completa', 70500, 1),
	(20, 'Hospedaje', 'Camping Élite Adulto', 94500, 1),
	(21, 'Hospedaje', 'Camping Élite Menor de edad', 42500, 1),
	(22, 'Hospedaje', 'Camping Élite Pareja', 189000, 1),
	(23, 'Decoración', 'Decoración Romántica Básica', 55000, 1),
	(24, 'Decoración', 'Decoración Cumpleaños Básica', 55000, 1),
	(25, 'Decoración', 'Decoración Romántica Cumpleaños', 100000, 1),
	(26, 'Decoración', 'Decoraciones - Adicional Copas', 10000, 1),
	(27, 'Decoración', 'Decoraciones - Adicional Torta', 25000, 1),
	(28, 'Decoración', 'Decoraciones - Adicional Vino', 30000, 1),
	(29, 'Hospedaje', 'Espacio para Acampar Adulto', 40000, 1),
	(30, 'Hospedaje', 'Espacio para Acampar Menor de edad', 20000, 1),
	(31, 'Parqueadero', 'Estacionamiento Carro (durante la estadía)', 20000, 1),
	(32, 'Parqueadero', 'Estacionamiento Moto (durante la estadía)', 10000, 1),
	(33, 'Náuticos y Aventura', 'Tour en Helicóptero (10 min x persona)', 330000, 1),
	(34, 'Náuticos y Aventura', 'Tour en Helicóptero Transporte Cali-Calima (x persona)', 660000, 1),
	(35, 'Bienestar', 'Masaje Relajante (x persona)', 49000, 1),
	(36, 'Bienestar', 'Masaje Relajante (x pareja)', 91000, 1),
	(37, 'Alimentación', 'Cine Picnic + Combo Básico (1 función x persona)', 24000, 1),
	(38, 'Experiencias', 'Siembra una Planta', 18000, 1),
	(39, 'Experiencias', 'Museo (x persona)', 10000, 1),
	(40, 'Experiencias', 'Yoga (1 hora, grupo de 10)', 195000, 1),
	(41, 'Náuticos y Aventura', 'Tour en Cuatrimoto (1 hora)', 242000, 1),
	(42, 'Náuticos y Aventura', 'Cabalgata (x persona)', 35000, 1),
	(43, 'Experiencias', 'Paintball (x persona)', 36000, 1),
	(44, 'Experiencias', 'Paintball Recarga (x bala)', 200, 1),
	(45, 'Decoración', 'Globo de Cantoya', 18000, 1),
	(46, 'Náuticos y Aventura', 'Jetski (20 min x pareja)', 120000, 1),
	(47, 'Náuticos y Aventura', 'Lancha o Pontón (30 min x persona)', 25000, 1),
	(48, 'Náuticos y Aventura', 'Pontón Exclusivo (45 min hasta 30 personas)', 500000, 1),
	(49, 'Náuticos y Aventura', 'Paddle o Kayak (1 hora x persona)', 45000, 1),
	(50, 'Náuticos y Aventura', 'Curso Kitesurf (6 horas x persona)', 1800000, 1),
	(51, 'Náuticos y Aventura', 'Alquiler Equipos Kitesurf', 300000, 1);

-- Volcando estructura para tabla mystic_reservas.usuarios
CREATE TABLE IF NOT EXISTS `usuarios` (
  `id_usuario` int(11) NOT NULL AUTO_INCREMENT,
  `nombre` varchar(100) NOT NULL,
  `email` varchar(150) NOT NULL,
  `password_hash` varchar(255) NOT NULL,
  `rol` enum('ASESOR','ADMIN','RECEPCION','OTRO') DEFAULT 'ASESOR',
  `creado_en` timestamp NOT NULL DEFAULT current_timestamp(),
  PRIMARY KEY (`id_usuario`),
  UNIQUE KEY `email` (`email`)
) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- Volcando datos para la tabla mystic_reservas.usuarios: ~1 rows (aproximadamente)
INSERT INTO `usuarios` (`id_usuario`, `nombre`, `email`, `password_hash`, `rol`, `creado_en`) VALUES
	(1, 'Admin Mystic', 'admin@mysticparadise.com', '$2b$12$jYWJNd8wOFS5TkhB1qQDEO7/tjiHughzf16Bn0iDNJfaCaJlI1A7C', 'ADMIN', '2025-12-03 17:07:26');

/*!40103 SET TIME_ZONE=IFNULL(@OLD_TIME_ZONE, 'system') */;
/*!40101 SET SQL_MODE=IFNULL(@OLD_SQL_MODE, '') */;
/*!40014 SET FOREIGN_KEY_CHECKS=IFNULL(@OLD_FOREIGN_KEY_CHECKS, 1) */;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40111 SET SQL_NOTES=IFNULL(@OLD_SQL_NOTES, 1) */;
